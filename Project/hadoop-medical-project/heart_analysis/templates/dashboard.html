<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Disease Analysis Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold mb-8 text-gray-800">Heart Disease Analysis Dashboard</h1>

        <!-- Analysis Results Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            {% for age_group, data in analysis_results.items()|sort %}
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-4">Age Group: {{ age_group }}s</h3>
                <div class="space-y-2">
                    <p class="text-gray-600">Average Cholesterol: 
                        <span class="font-bold text-gray-800">{{ data.avg_cholesterol }}</span>
                    </p>
                    <p class="text-gray-600">Average Heart Rate: 
                        <span class="font-bold text-gray-800">{{ data.avg_heart_rate }}</span>
                    </p>
                    <p class="text-gray-600">Average Blood Pressure: 
                        <span class="font-bold text-gray-800">{{ data.avg_blood_pressure }}</span>
                    </p>
                    <p class="text-gray-600">Patient Count: 
                        <span class="font-bold text-gray-800">{{ data.count }}</span>
                    </p>
                    <div class="mt-2">
                        <p class="text-sm font-semibold">Chest Pain Types:</p>
                        <div class="grid grid-cols-2 gap-2">
                            {% for type, count in data.chest_pain_distribution.items() %}
                            <p class="text-gray-600 text-sm">Type {{ type }}: {{ count }}</p>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Charts -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Cholesterol by Age Group</h2>
                <div id="cholesterolPlot"></div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Heart Rate by Age Group</h2>
                <div id="heartRatePlot"></div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Blood Pressure by Age Group</h2>
                <div id="bloodPressurePlot"></div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-bold mb-4">Patient Distribution</h2>
                <div id="distributionPlot"></div>
            </div>
        </div>
    </div>

    <script>
        const plots = {{ plots|safe }};
        
        Plotly.newPlot('cholesterolPlot', [plots.cholesterol], {
            title: 'Average Cholesterol by Age Group',
            xaxis: { title: 'Age Group' },
            yaxis: { title: 'Average Cholesterol' }
        });

        Plotly.newPlot('heartRatePlot', [plots.heart_rate], {
            title: 'Average Heart Rate by Age Group',
            xaxis: { title: 'Age Group' },
            yaxis: { title: 'Average Heart Rate (bpm)' }
        });

        Plotly.newPlot('bloodPressurePlot', [plots.blood_pressure], {
            title: 'Average Blood Pressure by Age Group',
            xaxis: { title: 'Age Group' },
            yaxis: { title: 'Average Blood Pressure (mm Hg)' }
        });

        Plotly.newPlot('distributionPlot', [plots.distribution], {
            title: 'Patient Distribution by Age Group',
            xaxis: { title: 'Age Group' },
            yaxis: { title: 'Number of Patients' }
        });
    </script>
</body>
</html>